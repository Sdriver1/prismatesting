import { db } from "../startup/db.js";
import SQL from "sql-template-strings";
import { does_currency_exist } from "../currency/operations/does_currency_exist.js";
export async function get_currency_leaderboard(data) {
    if (!(await does_currency_exist(data.currency_id))) {
        throw new Error("Make sure you specified a valid currency!");
    }
    if (data.max_index < data.min_index)
        throw new Error("Minimum index should not be greater than maximum index");
    const rows = await db.all(SQL `SELECT user_id, amount FROM user_currencies WHERE currency_id = ${data.currency_id} ORDER BY amount DESC`);
    let result = [];
    for (let i = data.min_index; i < data.max_index; i++) {
        if (rows[i])
            result.push(rows[i]);
    }
    return result;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZ2VuZXJhdGVfbGVhZGVyYm9hcmQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMvY29tbWFuZF9wYXJ0cy9nZW5lcmF0ZV9sZWFkZXJib2FyZC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUUsRUFBRSxFQUFFLE1BQU0sa0JBQWtCLENBQUM7QUFDdEMsT0FBTyxHQUFHLE1BQU0sc0JBQXNCLENBQUM7QUFDdkMsT0FBTyxFQUFFLG1CQUFtQixFQUFFLE1BQU0sK0NBQStDLENBQUM7QUFZcEYsTUFBTSxDQUFDLEtBQUssVUFBVSx3QkFBd0IsQ0FDNUMsSUFBNEI7SUFFNUIsSUFBSSxDQUFDLENBQUMsTUFBTSxtQkFBbUIsQ0FBQyxJQUFJLENBQUMsV0FBVyxDQUFDLENBQUMsRUFBRSxDQUFDO1FBQ25ELE1BQU0sSUFBSSxLQUFLLENBQUMsMkNBQTJDLENBQUMsQ0FBQztJQUMvRCxDQUFDO0lBQ0QsSUFBSSxJQUFJLENBQUMsU0FBUyxHQUFHLElBQUksQ0FBQyxTQUFTO1FBQ2pDLE1BQU0sSUFBSSxLQUFLLENBQUMsd0RBQXdELENBQUMsQ0FBQztJQUM1RSxNQUFNLElBQUksR0FBRyxNQUFNLEVBQUUsQ0FBQyxHQUFHLENBQ3ZCLEdBQUcsQ0FBQSxtRUFBbUUsSUFBSSxDQUFDLFdBQVcsdUJBQXVCLENBQzlHLENBQUM7SUFDRixJQUFJLE1BQU0sR0FBRyxFQUFFLENBQUM7SUFDaEIsS0FBSyxJQUFJLENBQUMsR0FBRyxJQUFJLENBQUMsU0FBUyxFQUFFLENBQUMsR0FBRyxJQUFJLENBQUMsU0FBUyxFQUFFLENBQUMsRUFBRSxFQUFFLENBQUM7UUFDckQsSUFBSSxJQUFJLENBQUMsQ0FBQyxDQUFDO1lBQUUsTUFBTSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztJQUNwQyxDQUFDO0lBQ0QsT0FBTyxNQUFNLENBQUM7QUFDaEIsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGRiIH0gZnJvbSBcIi4uL3N0YXJ0dXAvZGIuanNcIjtcclxuaW1wb3J0IFNRTCBmcm9tIFwic3FsLXRlbXBsYXRlLXN0cmluZ3NcIjtcclxuaW1wb3J0IHsgZG9lc19jdXJyZW5jeV9leGlzdCB9IGZyb20gXCIuLi9jdXJyZW5jeS9vcGVyYXRpb25zL2RvZXNfY3VycmVuY3lfZXhpc3QuanNcIjtcclxuXHJcbmludGVyZmFjZSBMZWFkZXJib2FyZEJ1aWxkZXJEYXRhIHtcclxuICBtaW5faW5kZXg6IG51bWJlcjtcclxuICBtYXhfaW5kZXg6IG51bWJlcjtcclxuICBjdXJyZW5jeV9pZDogc3RyaW5nO1xyXG59XHJcblxyXG5pbnRlcmZhY2UgTGVhZGVyYm9hcmRDdXJyZW5jeURhdGEge1xyXG4gIHVzZXJfaWQ6IHN0cmluZztcclxuICBhbW91bnQ6IG51bWJlcjtcclxufVxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0X2N1cnJlbmN5X2xlYWRlcmJvYXJkKFxyXG4gIGRhdGE6IExlYWRlcmJvYXJkQnVpbGRlckRhdGFcclxuKTogUHJvbWlzZTxMZWFkZXJib2FyZEN1cnJlbmN5RGF0YVtdPiB7XHJcbiAgaWYgKCEoYXdhaXQgZG9lc19jdXJyZW5jeV9leGlzdChkYXRhLmN1cnJlbmN5X2lkKSkpIHtcclxuICAgIHRocm93IG5ldyBFcnJvcihcIk1ha2Ugc3VyZSB5b3Ugc3BlY2lmaWVkIGEgdmFsaWQgY3VycmVuY3khXCIpO1xyXG4gIH1cclxuICBpZiAoZGF0YS5tYXhfaW5kZXggPCBkYXRhLm1pbl9pbmRleClcclxuICAgIHRocm93IG5ldyBFcnJvcihcIk1pbmltdW0gaW5kZXggc2hvdWxkIG5vdCBiZSBncmVhdGVyIHRoYW4gbWF4aW11bSBpbmRleFwiKTtcclxuICBjb25zdCByb3dzID0gYXdhaXQgZGIuYWxsKFxyXG4gICAgU1FMYFNFTEVDVCB1c2VyX2lkLCBhbW91bnQgRlJPTSB1c2VyX2N1cnJlbmNpZXMgV0hFUkUgY3VycmVuY3lfaWQgPSAke2RhdGEuY3VycmVuY3lfaWR9IE9SREVSIEJZIGFtb3VudCBERVNDYFxyXG4gICk7XHJcbiAgbGV0IHJlc3VsdCA9IFtdO1xyXG4gIGZvciAobGV0IGkgPSBkYXRhLm1pbl9pbmRleDsgaSA8IGRhdGEubWF4X2luZGV4OyBpKyspIHtcclxuICAgIGlmIChyb3dzW2ldKSByZXN1bHQucHVzaChyb3dzW2ldKTtcclxuICB9XHJcbiAgcmV0dXJuIHJlc3VsdDtcclxufVxyXG4iXX0=